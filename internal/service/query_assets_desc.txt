Query the assets database with SQL. Only SELECT is allowed. This can be used to get information or statistics about assets and answer questions. Only 15 results can be returned from queries (use LIMIT 16 and you will receive max 15 results with info if the resultset was truncated). If there are more results than that, then the user should be told to be more specific to narrow the results.

Here is the database definition:

CREATE TABLE assets (
    id UUID PRIMARY KEY, -- Asset ID
    type TEXT NOT NULL, -- Asset type, one of [domain, subdomain, dns_record, ip_address, port, network, service]
    parent_id UUID REFERENCES assets(id), -- Parent Asset ID
    parent_type TEXT, -- Parent asset type, one of [domain, subdomain, dns_record, ip_address, port, network, service]
    details JSONB NOT NULL -- Asset details (see below)
    tags []TEXT NOT NULL, -- List of user-defined tags to categorize
);

Regarding parents, the assets have these parental hierarchies:
domain <- subdomain <- service(class:hostname)
subdomain <- dns_record <- ip_address <- port <- service(class:ip)
network <- ip_address // alternative to dns_record

The 'service' type can have either subdomain or port parent, depending on class

For "domain" type, details contains { 
    "domain": full domain name
    "registrar": name of registrar, e.g., "AWS Route 53", "Namecheap"
    "expiry": unix timestamp of expiration date
}

For "subdomain" type, details contains {
    "name": FQDN name of the subdomain (no trailing dot)
}

For "dns_record" type, details contains {
    "record_type": one of [A, AAAA, CNAME, MX, TXT]. May also include other standard record types.
    "name": dns name
    "value": dns value
    "ttl": in seconds
}

For "ip_address", details contains {
    "ip": IPv4 or IPv6 formatted address
    "location": geolocation country info, e.g., "US"
}

For "port", details contains {
    "protocol": one of [tcp, udp]
    "reachable": boolean, indicating if the internet can connect to it
    "ip": parent IP address
}

For "network", details contains {
    "cidr": cidr string the network includes
}

For "service" type, details contains {
    "class": 'hostname' or 'ip'; for 'ip' the hostname is a direct IP address
    "hostname": hostname of the service
    "port": port the service listens on
    "protocol": e.g., "https", aka the scheme
    "path": path that the service listens on, e.g., the path part of a URL, including initial "/"
    "ip_list": list of IP addresses linked to this service
    "cpe_list": list of CPEs that the service matches
}
